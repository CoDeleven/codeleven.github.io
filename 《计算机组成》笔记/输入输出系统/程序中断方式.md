---
title: 程序中断方式
date: 2018-07-27 15:02:53
tags: 计算机组成
---

# 概述
计算机在执行程序得过程中，当出现异常情况或特殊请求时，计算机停止现行程序（（正在运行的程序）），转向对这些异常情况或特殊请求得处理，处理后再返回到现行程序的间断处。

由于CPU和IO设备速度的不匹配，CPU通常要等待一段时间，才能实现主机与IO设备之间的信息交换。所以当CPU启动了IO设备之后，就转去执行现行程序，让IO设备准备好后主动通知（中断）CPU，CPU转去执行中断程序，进行数据交换。这就是IO中断。

![打印机的中断]](https://blog-1252749790.cos.ap-shanghai.myqcloud.com/ComputerOrganization%2FIOSystem%2FIO%E4%B8%AD%E6%96%AD%E6%89%93%E5%8D%B0%E6%9C%BA%E7%A4%BA%E6%84%8F%E5%9B%BE.png)

# 中断方式的电路
## 中断请求触发器和中断屏蔽触发器
每台外部设备都必须配置一个中断请求触发器INTR，当其为“1”时，表示该设备向CPU提出中断请求。同时也需要一个配对的 **中断屏蔽器**，用于屏蔽一些低优先级的中断请求（面对多个中断请求时），当它为“1”时，表示封锁其中断源。其电路逻辑图如下所示

![接口电路中D、INTR、MASK和中断查询信号的关系](https://blog-1252749790.cos.ap-shanghai.myqcloud.com/ComputerOrganization%2FIOSystem%2FD%E3%80%81INTR%E3%80%81MASK%E4%B8%89%E8%80%85%E7%9A%84%E4%BF%A1%E6%81%AF%E5%85%B3%E7%B3%BB.png)

当设备准备就绪D为“1”、且该设备MASK不为“0”时，由CPU在指令执行结束阶段时，由CPU发出中断查询信号，将INTR设置为“1”

## 排队器
当多个中断源同时向CPU发出请求时，CPU会根据中断源的不同性质对其排队，给予不同等级的优先权，并按优先级等级给予响应。
> 通常来说速度越快的IO设备，优先级越高，因为不及时响应高速的IO请求，信息可能会发生丢失。

排队器分为硬件排队器和软件排队器：这里只介绍硬件排队器，下图是硬件排队器的电路

![链式排队器](https://blog-1252749790.cos.ap-shanghai.myqcloud.com/ComputerOrganization%2FIOSystem%2F%E9%93%BE%E5%BC%8F%E6%8E%92%E9%98%9F%E5%99%A8.png)

当各个中断源无请求时，各个INTR<sup>-</sup>均为高电平。一旦某个中断源提出中断请求时，就会让优先级低的中断源变为低电平，封锁其中的中断请求。比如当2、3号中断源同时有请求时（INTR2<sup>-</sup>、INTR3<sup>-</sup>均为0），流程如图所示

![链式排队器距离图](https://blog-1252749790.cos.ap-shanghai.myqcloud.com/ComputerOrganization%2FIOSystem%2F%E9%93%BE%E5%BC%8F%E6%8E%92%E9%98%9F%E5%99%A8%E4%B8%BE%E4%BE%8B%E5%9B%BE.png)

INTR<sub>i</sub><sup>-</sup> 没有提出请求时均为高电平，根据例子，二、三号中断源提出请求，二、三号输入低电压，由于二号经过与非门输出高电压，经过三号的非门，输出低电压，让三号无法被选。此时因为INTP<sub>1</sub><sup>'</sup>和INTP<sub>2</sub><sup>'</sup>输出都为高电压，又通过INTP<sub>i</sub>来和输出信号进行与运算，最终输出INTP<sub>2</sub>
